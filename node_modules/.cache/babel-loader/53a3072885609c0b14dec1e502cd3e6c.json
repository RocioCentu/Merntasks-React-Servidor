{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rocio\\\\OneDrive\\\\Escritorio\\\\Curso react\\\\Mern\\\\cliente\\\\src\\\\context\\\\autenticacion\\\\authState.js\";\nimport React, { useReducer } from 'react';\nimport authContext from './authContext';\nimport authReducer from './authReducer';\nimport tokenAuth from '../../config/todkenAuth'; //axios para comunicarnos con el backend\n\nimport clienteAxios from '../../config/axios';\nimport { REGISTRO_EXITOSO, REGISTRO_ERROR, OBTENER_USUARIO, LOGIN_EXITOSO, LOGIN_ERROR, CERRAR_SESION } from '../../types';\n\nconst AuthState = props => {\n  const initialState = {\n    token: localStorage.getItem('token'),\n    autenticado: null,\n    usuario: null,\n    mensaje: null\n  }; //dispath para ejecutar las acciones\n\n  const [state, dispath] = useReducer(authReducer, initialState);\n\n  const registrarUsuario = async datos => {\n    try {\n      const respuesta = await clienteAxios.post('/api/usuarios', datos);\n      dispath({\n        type: REGISTRO_EXITOSO,\n        payload: respuesta.data //es el token del servidor\n\n      }); //Obtener usuario autenticado\n\n      usuarioAutenticado();\n    } catch (error) {\n      // el error me viene del backend\n      const alerta = {\n        msg: error.response.data.msg,\n        categoria: 'alerta-error'\n      };\n      dispath({\n        type: REGISTRO_ERROR,\n        payload: alerta\n      });\n    }\n  };\n\n  const usuarioAutenticado = async datos => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      //funcion para enviar el token por headers\n      tokenAuth(token);\n\n      try {\n        const respuesta = await clienteAxios.get('/api/usuarios', datos);\n        dispath({\n          type: OBTENER_USUARIO,\n          payload: respuesta.data.usuario\n        });\n      } catch (error) {\n        const alerta = {\n          msg: error.response.data.msg,\n          categoria: 'alerta-error'\n        };\n        dispath({\n          type: LOGIN_ERROR,\n          payload: alerta\n        });\n      }\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(authContext.Provider, {\n    value: {\n      token: state.token,\n      autenticado: state.autenticado,\n      mensaje: state.mensaje,\n      usuario: state.usuario,\n      registrarUsuario\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }\n  }, props.children);\n};\n\nexport default AuthState;","map":{"version":3,"sources":["C:/Users/rocio/OneDrive/Escritorio/Curso react/Mern/cliente/src/context/autenticacion/authState.js"],"names":["React","useReducer","authContext","authReducer","tokenAuth","clienteAxios","REGISTRO_EXITOSO","REGISTRO_ERROR","OBTENER_USUARIO","LOGIN_EXITOSO","LOGIN_ERROR","CERRAR_SESION","AuthState","props","initialState","token","localStorage","getItem","autenticado","usuario","mensaje","state","dispath","registrarUsuario","datos","respuesta","post","type","payload","data","usuarioAutenticado","error","alerta","msg","response","categoria","get","children"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,UAAhB,QAAkC,OAAlC;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,SAAP,MAAsB,yBAAtB,C,CACA;;AACA,OAAOC,YAAP,MAAyB,oBAAzB;AACA,SAASC,gBAAT,EAA0BC,cAA1B,EAAyCC,eAAzC,EAAyDC,aAAzD,EAAuEC,WAAvE,EAAmFC,aAAnF,QAAuG,aAAvG;;AAIA,MAAMC,SAAS,GAAEC,KAAK,IAAE;AAEpB,QAAMC,YAAY,GAAC;AAChBC,IAAAA,KAAK,EAACC,YAAY,CAACC,OAAb,CAAqB,OAArB,CADU;AAEhBC,IAAAA,WAAW,EAAC,IAFI;AAGhBC,IAAAA,OAAO,EAAC,IAHQ;AAIhBC,IAAAA,OAAO,EAAC;AAJQ,GAAnB,CAFoB,CASpB;;AACA,QAAM,CAACC,KAAD,EAAOC,OAAP,IAAiBrB,UAAU,CAACE,WAAD,EAAaW,YAAb,CAAjC;;AAGA,QAAMS,gBAAgB,GAAC,MAAMC,KAAN,IAAc;AAClC,QAAG;AACA,YAAMC,SAAS,GAAE,MAAMpB,YAAY,CAACqB,IAAb,CAAkB,eAAlB,EAAmCF,KAAnC,CAAvB;AACAF,MAAAA,OAAO,CAAC;AACNK,QAAAA,IAAI,EAACrB,gBADC;AAENsB,QAAAA,OAAO,EAACH,SAAS,CAACI,IAFZ,CAEiB;;AAFjB,OAAD,CAAP,CAFA,CAMF;;AACDC,MAAAA,kBAAkB;AAEjB,KATD,CASC,OAAMC,KAAN,EAAY;AAAE;AACZ,YAAMC,MAAM,GAAC;AACTC,QAAAA,GAAG,EAACF,KAAK,CAACG,QAAN,CAAeL,IAAf,CAAoBI,GADf;AAETE,QAAAA,SAAS,EAAC;AAFD,OAAb;AAKAb,MAAAA,OAAO,CAAC;AACJK,QAAAA,IAAI,EAACpB,cADD;AAEJqB,QAAAA,OAAO,EAAEI;AAFL,OAAD,CAAP;AAIH;AAEF,GAtBD;;AAyBA,QAAMF,kBAAkB,GAAC,MAAMN,KAAN,IAAc;AAE/B,UAAMT,KAAK,GAAEC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAb;;AACH,QAAGF,KAAH,EAAS;AACL;AACAX,MAAAA,SAAS,CAACW,KAAD,CAAT;;AAGA,UAAI;AACD,cAAMU,SAAS,GAAE,MAAMpB,YAAY,CAAC+B,GAAb,CAAiB,eAAjB,EAAkCZ,KAAlC,CAAvB;AAGAF,QAAAA,OAAO,CAAC;AACJK,UAAAA,IAAI,EAACnB,eADD;AAEJoB,UAAAA,OAAO,EAAEH,SAAS,CAACI,IAAV,CAAeV;AAFpB,SAAD,CAAP;AAIF,OARD,CAQE,OAAOY,KAAP,EAAc;AACb,cAAMC,MAAM,GAAC;AACTC,UAAAA,GAAG,EAACF,KAAK,CAACG,QAAN,CAAeL,IAAf,CAAoBI,GADf;AAETE,UAAAA,SAAS,EAAC;AAFD,SAAb;AAKAb,QAAAA,OAAO,CAAC;AACJK,UAAAA,IAAI,EAACjB,WADD;AAEJkB,UAAAA,OAAO,EAAEI;AAFL,SAAD,CAAP;AAIF;AACJ;AAEJ,GA7BF;;AAkCA,sBACI,oBAAC,WAAD,CAAa,QAAb;AACA,IAAA,KAAK,EAAE;AACHjB,MAAAA,KAAK,EAACM,KAAK,CAACN,KADT;AAEHG,MAAAA,WAAW,EAAEG,KAAK,CAACH,WAFhB;AAGHE,MAAAA,OAAO,EAACC,KAAK,CAACD,OAHX;AAIHD,MAAAA,OAAO,EAACE,KAAK,CAACF,OAJX;AAKHI,MAAAA;AALG,KADP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAWKV,KAAK,CAACwB,QAXX,CADJ;AAgBH,CAxFD;;AA0FA,eAAezB,SAAf","sourcesContent":["import React, { useReducer } from 'react';\r\nimport authContext from './authContext';\r\nimport authReducer from './authReducer';\r\nimport tokenAuth from '../../config/todkenAuth';\r\n//axios para comunicarnos con el backend\r\nimport clienteAxios from '../../config/axios';\r\nimport { REGISTRO_EXITOSO,REGISTRO_ERROR,OBTENER_USUARIO,LOGIN_EXITOSO,LOGIN_ERROR,CERRAR_SESION} from '../../types';\r\n\r\n\r\n\r\nconst AuthState= props=>{\r\n\r\n    const initialState={\r\n       token:localStorage.getItem('token'),\r\n       autenticado:null,\r\n       usuario:null,\r\n       mensaje:null\r\n    }\r\n\r\n    //dispath para ejecutar las acciones\r\n    const [state,dispath]= useReducer(authReducer,initialState);\r\n \r\n\r\n    const registrarUsuario=async(datos)=>{\r\n       try{\r\n          const respuesta= await clienteAxios.post('/api/usuarios', datos);\r\n          dispath({\r\n            type:REGISTRO_EXITOSO,\r\n            payload:respuesta.data //es el token del servidor\r\n        });\r\n        //Obtener usuario autenticado\r\n       usuarioAutenticado();\r\n\r\n       }catch(error){ // el error me viene del backend\r\n          const alerta={\r\n              msg:error.response.data.msg,\r\n              categoria:'alerta-error'\r\n          }\r\n\r\n          dispath({\r\n              type:REGISTRO_ERROR,\r\n              payload: alerta\r\n          })\r\n      }       \r\n    \r\n    }\r\n\r\n\r\n    const usuarioAutenticado=async(datos)=>{\r\n   \r\n            const token= localStorage.getItem('token');\r\n         if(token){\r\n             //funcion para enviar el token por headers\r\n             tokenAuth(token);\r\n\r\n\r\n             try {\r\n                const respuesta= await clienteAxios.get('/api/usuarios', datos);\r\n\r\n\r\n                dispath({\r\n                    type:OBTENER_USUARIO,\r\n                    payload: respuesta.data.usuario\r\n                });\r\n             } catch (error) {\r\n                const alerta={\r\n                    msg:error.response.data.msg,\r\n                    categoria:'alerta-error'\r\n                }\r\n      \r\n                dispath({\r\n                    type:LOGIN_ERROR,\r\n                    payload: alerta\r\n                });\r\n             }\r\n         }\r\n     \r\n     }\r\n \r\n  \r\n\r\n   \r\n    return(\r\n        <authContext.Provider\r\n        value={{\r\n            token:state.token,\r\n            autenticado: state.autenticado,\r\n            mensaje:state.mensaje,\r\n            usuario:state.usuario,\r\n            registrarUsuario\r\n          \r\n        }}\r\n        >\r\n  \r\n            {props.children}\r\n        </authContext.Provider>\r\n  \r\n    );\r\n}\r\n\r\nexport default AuthState;"]},"metadata":{},"sourceType":"module"}